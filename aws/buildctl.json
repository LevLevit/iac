{
    "modules": [
        {
            "module": "base",
            "action": "apply",
            "target": ["localhost", "network", "iam", "ssm"],
            "terraform": true,
            "ansible": true
        },
        {
            "module": "base",
            "action": "destroy",
            "target": ["ssm", "iam", "network"],
            "terraform": true,
            "ansible": false
        }, 
        {
            "module": "base-vpn",
            "action": "apply",
            "target": ["client-vpn"],
            "terraform": true,
            "ansible": false,
            "playbook": "playbook.yaml",
            "depends_on": "base"
        },
        {
            "module": "base-vpn",
            "action": "destroy",
            "target": ["client-vpn"],
            "terraform": true,
            "ansible": false,
            "depends_on": "base"
        },
        {
            "module": "base-bastion",
            "action": "apply",
            "target": ["bastion"],
            "terraform": true,
            "ansible": true,
            "playbook": "playbook.yaml",
            "depends_on": "base"
        },
        {
            "module": "base-bastion",
            "action": "destroy",
            "target": ["bastion"],
            "terraform": true,
            "ansible": false,
            "depends_on": "base"
        },
        {
            "module": "syslog-forwarding", 
            "action": "apply",
            "target": ["bastion", "docker"],
            "terraform": false,
            "ansible": true,
            "playbook": "playbook-syslog.yaml" 
        },
        {
            "module": "syslog-docker", 
            "action": "apply",
            "target": ["syslog", "docker"],
            "terraform": false,
            "ansible": true,
            "playbook": "playbook-syslog-docker.yaml" 
        },
        {
            "module": "syslog-kafka", 
            "action": "apply",
            "target": ["syslog"],
            "terraform": false,
            "ansible": true,
            "playbook": "playbook-syslog-kafka.yaml" 
        },
        {
            "module": "syslog-default",
            "action": "apply",
            "target": ["syslog", "syslog-forwarding", "syslog-docker"], 
            "terraform": true,
            "ansible": true,
            "playbook": "playbook.yaml"
        },       
        {
            "module": "lb",
            "action": "apply",
            "target": ["alb", "ecr"], 
            "terraform": true,
            "ansible": true,
            "playbook": "playbook.yaml",
            "depends_on": "base-bastion" 
        },
        {
            "module": "lb",
            "action": "destroy",
            "target": ["ecr", "alb"], 
            "terraform": true,
            "ansible": false,
            "depends_on": "base-bastion" 
        },                                                       
        {
            "module": "lb-docker",
            "action": "apply",
            "target": ["docker"], 
            "terraform": true,
            "ansible": true,
            "playbook": "playbook.yaml",
            "depends_on": "lb" 
        },
        {
            "module": "lb-docker",
            "action": "destroy",
            "target": ["docker"],
            "terraform": true,
            "ansible": false,
            "depends_on": "lb"
        },
        {
            "module": "lb-app",
            "action": "apply",
            "target": ["rds-mysql", "deploy-schemas"], 
            "terraform": true,
            "ansible": true,
            "playbook": "playbook.yaml",
            "depends_on": "lb-docker" 
        },
        {
            "module": "lb-app",
            "action": "destroy",
            "target": ["rds-mysql"],
            "terraform": true,
            "ansible": false,
            "depends_on": "lb-docker"
        }
    ],
    "resources" : [
        {
            "target": "bastion",
            "type": "vm"   
        },
        {
            "target": "docker",
            "type": "vm"
        },
        {
            "target": "syslog",
            "type": "vm"
        }
    ]
}